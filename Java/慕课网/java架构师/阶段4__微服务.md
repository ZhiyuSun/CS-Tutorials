## 阶段4_微服务

### 微服务

eureka 服务治理

ribbon 负载均衡

hystrix 服务容错

feign 服务间调用

config 分布式配置中心

bus 消息总线

gateway 服务网关

sleuth 调用链追踪

stream 消息驱动

sentinel 限流

#### 优点：

- 快速响应变更
  - 单一职责
  - 独立部署
- 精粒度业务控制
  - 降级熔断
  - 局部限流
- 独立拓展
  - 边界清晰
  - 不过度受制于技术栈
- 面向业务/领域模型
  - 不依赖数据模型
  - 易于抽象

#### 缺点

- 部署结构复杂
  - 模块众多
  - 一堆额外组件
- 依赖平台支撑
  - 依赖微服务组件
  - 研发成本
- 分布式问题
  - 一致性
  - 异常补偿
- 拆分的水平
  - 粒度过粗过细——王者变青铜

#### 业务角度

- 业务规模（做不做）（衡量成本与收益）
- 理解业务领域（业务架构，领域模型）（怎么做）

### Spring cloud 简介

服务间调用，把对方的接口引入进来。foodie-api（纯接口层）

### Eureka

#### 分布式系统CAP定理

C：一致性。**强一致性**，弱一致性，最终一致性

A：可用性。99.999% 宕机<5min

P：分区容错性。在一致性和可用性之间做抉择

CAP大定理：分布式系统只能三选二，不能全占

#### 服务治理三大门派

Eureka, Consul, Nacos

#### 架构选型

- 对当前业务的支持
- 未来研发支持（社区，商业公司）
- 团队技术栈&学习成本
- 替换成本&运维成本

#### 技术改造

dependencymanagement作用

eureka是基于http的框架

### Ribbon

#### 负载均衡

- 雨露均沾
- 不能让某个人特别累
- 要累一起累

#### 客户端和服务器端负载均衡

（图）

#### 一致性哈希

### Feign

服务间通信与调用

#### 服务间调用

Feign解决了什么问题

- 简化远程调用
- 集成Ribbon
- 集成Hystrix

### Hystrix

断：熔断

舍：降级

离：线程隔离

#### request cache

#### 架构思考

主链路，漏洞模型

#### Turbine和Hystrix-dashboard

#### 实操

内部的降级，放到内部来实现

调用方降级，由调用方定义降级逻辑

#### 笔记

- 对系统架构层面冲击的，是用户体量
- 在互联网行业做架构要有设计裕量，在架构方面多考虑
- 阅读开源项目代码是一个快速提高代码能力的途径，如果你平时很少深入研究大型开源项目，不知道从哪里下手，那么建议你先从一些小型开源项目入手，Ribbon这种短小精悍的组件就是一个不错的选择。
- 扩大自己的影响力，有意识培养这种能力（Ribbon 1-8），交际能力，总结陈词，演讲，presentation。国内不可能一直在一线，用于表达自己，不要害怕做不好。
- 不要只关注自己的一亩三分地，多看开源软件的项目，从中汲取营养
- 眼中有码，心中无码
- 开源软件源码：神龙见首不见尾。掌握方法
- 如果时间比较充足，并且想系统的学习一门技术，可以尝试从官方的文档开始，利用开源社区的资料加上阅读远吗，深入了解一个技术的方方面面。从我个人经验来讲，国外的开源社区和stackoverflow这类网站都可以提供很好的帮助，国外技术圈并不像国内这般浮躁，很多社区大牛也非常有奉献精神，大家没事可以经常去逛一逛这些社区，看看别人提出的问题，如果有你可以解答的问题也不妨去尝试解决一下。
- 学会展示自己





